(in-package #:vex)


;;;; Utils --------------------------------------------------------------------
(eval-when (:compile-toplevel :load-toplevel :execute)
  (defun permutations (seq)
    (let (result)
      ; jesus christ alexandria
      (map-permutations (lambda (p) (push p result)) seq)
      result))

  (defun english-list (l)
    ;; thanks seibel
    (format nil "［箕狺箕犷狺夯利狺［滑犷夯蔺蔺飑┅ㄤ邈灬轫ㄩ铎轭篑踽蝈┅ㄤ彐躅篑踽蝈í┅ㄤ彐磲泸溴骢铙钺礤蝈篝蝈篝啜痱镧括祜镳烘矧钺礤洪钺礤恒镬戾泗啜溴骢钺礤莉弩舂┅换换郁蝓泗ㄤ彐磲泸溴骣邈钺礤箪雉狎珈轶豉疱溴驷蹯舂啜痱镧ㄤ邈灬轫ㄩ铎轭钺礤┅ㄤ彐篝蝓泗ì钺礤ê泔铙趄蹉麸钺礤狎珈轶舂ㄦ矧磲铋⒘噎溟礤铙轱钺鲥泗矧镦帼拎螽戾铉翳箪雉螬豉疱括祜镳烘矧箪雉洪箪雉恒镬戾泗啜箪雉溴驷蹯呼疱豉疱┅┅ㄤ彐磲泸溴骣邈钺礤豉疱溴驷蹯舂啜溴骣邈钺礤é镳糸镱犰溴驷蹯舂┅豉疱溴驷蹯舂ㄤ彐磲泸溴骣邈钺礤豉疱溴驷蹯舂啜溴骣邈钺礤é镳糸镱犰溴驷蹯舂┅豉疱溴驷蹯舂ㄤ彐磲泸溴骣邈钺礤豉疱溴驷蹯舂啜溴骣邈钺礤鳗é镳糸镱犰溴驷蹯舂┅豉疱溴驷蹯舂ㄤ彐鲥悴鲥悴蝈犰癌ㄤ彐鲥悴鲥悴箝铉戾骒镝版癌ㄤ彐鲥悴鲥悴滹踱戾骒镝颁癌ㄤ彐鲥悴鲥悴骈铛癌ㄤ彐鲥愠鲥愠蝈犰癌ㄤ彐鲥愠鲥愠箝铉戾骒镝版癌ㄤ彐鲥愠鲥愠滹踱戾骒镝颁癌ㄤ彐鲥愠鲥愠骈铛癌ㄤ彐鲥愦鲥愦蝈犰癌ㄤ彐鲥愦鲥愦箝铉戾骒镝版癌ㄤ彐鲥愦鲥愦滹踱戾骒镝颁癌ㄤ彐鲥愦鲥愦骈铛癌换换橡弪狒轱铙ㄤ彐磲泸溴骈铄篦辁戾鲥悱豉疱蝈篝狎珞灬忮祗è徙沐篌矧簌礅镬簌礅鲥悱豉疱Л簌礅镬┅ㄤ镢篝蜷铉狎珞ㄡ蜱螬ㄥ铉扉箬扉篝磲疸狎ㄣ躜蝙＇骘蝽狒铋⑧窿┼狎珞┅ㄤ镢篝蜷铉骝弩ㄡ蜱螬ㄦ矧磲铋⒂鏖戾圉喱蝈趱蝾轭铄帼窿┼镦轸泔眇镱孱趔鲥悱豉疱ㄤ镢篝蜷铉狎珞狎珞┅ㄤ镢篝蜷铉轭痨徙ㄡ蜱螬ㄦ矧磲铋⒂鏖戾圉轭痨徙犷蝈趱蝾轸箦趑轭轸泔眇镱孱趔麸廉ㄤ镢篝蜷铉狎珞狎珞┅┅啜痱镧括祜镳烘矧疱蝽洪疱蝽豸狒轱铙狎珞烘矧钺礤ㄡ痧禊＇簌礅鲥悱豉疱Л疱蝽烘矧钺礤簌礅钺礤А恒镬戾泗啜溴沆衢ㄦ豉疱ㄦ躅泗轱ì鲥悱豉疱鲠祯弩鲥悱豉疱镳糸镱犰┅钺礤钺礤々恒镬戾泗啜溴骢钺礤雯ㄤ镢篝蜷铉骝弩疱蝽ì鲥悱豉疱括祜镳烘矧徙沐篌矧洪磲疸狎＇徙沐篌矧疱蝽恒镬戾泗啜徙沐篌矧雯┅恒镬戾泗啜溴骢钺礤雯ㄤ镢篝蜷铉轭痨徙疱蝽痼弭括祜镳烘矧狎绛徙沐篌矧洪磲疸狎＇徙沐篌矧狎珞烘矧疱蝽徙沐篌矧洪磲疸狎＇徙沐篌矧疱蝽恒镬戾泗啜狎绛徙沐篌矧雯恒镬戾泗啜疱蝽徙沐篌矧雯┅雯┅┅ㄤ彐磲泸鏖翳骖鲥悱豉疱屐屙孱舡豉疱怙澌怙澌啜磲泸镬弭è鲥é蝈篝狎珞啜К鲥悱豉疱泪蜱螬鲥悱雯啜簌礅К鲥悱豉疱Л雯鲥悱雯啜簌礅К鲥悱豉疱Л雯鲥悱雯啜簌礅К鲥悱豉疱Л雯鲥悱雯啜簌礅К鲥悱豉疱Л鳗雯ㄩㄥ屐屙孱舡豉疱ф轼铛愆啜黩狃啜祜玑钿盹篝痫箝糸鲥骈铛┅啜黩狃┅ㄩㄥ屐屙孱舡豉疱ф轼铛愆啜啜骒镲┅啜啜┅┅棱镤┅ㄤ彐磲泸溴骣邈诧痼鲥悱豉疱屐屙孱舡豉疱戾è徜簌礅鲥悱豉疱Л徜洎ㄡ滗簌礅鲥悱豉疱Л徜洫┅ㄡ滗簌礅鲥悱豉疱Л徜洹┅ㄡ滗簌礅鲥悱豉疱Л徜洫々篚簌礅鲥悱豉疱Л篚猢篚猹簌礅鲥悱豉疱Л篚猹┅篚狻簌礅鲥悱豉疱Л篚狻┅篚猹簌礅鲥悱豉疱Л篚猹々眭簌礅鲥悱豉疱Л眭飑眭臁簌礅鲥悱豉疱Л眭臁┅ㄤ轹簌礅鲥悱豉疱Л溟雯ㄤ轹簌礅鲥悱豉疱Л溟觥┅ㄥ耢簌礅鲥悱豉疱Л羼飑弪簌礅鲥悱豉疱Л弪铹躅轸簌礅鲥悱豉疱Л躅轸┅躅轸簌礅鲥悱豉疱Л躅轸┅磲玟轵簌礅鲥悱豉疱Л磲玟轵┅磲珙轸蹁簌礅鲥悱豉疱Л磲珙轸蹁濠戾铉翳簌礅鲥悱豉疱Л戾铉翳┅ㄡ铉戾簌礅鲥悱豉疱Л犷珈濠ㄤ轵邈糸镱簌礅鲥悱豉疱Л溟蝈泗轱瞟箦簟簌礅鲥悱豉疱Л箦簟┅啜痱镧ㄤ邈灬轫ㄦ豉疱ㄦ躅泗轱ī鲠祯弩鲥悱豉疱镳糸镱犰┅弪躅轸躅轸ㄦ豉疱ㄦ躅泗轱ì屐屙孱舡豉疱屐屙孱舡豉疱鲠祯弩鲥悱豉疱镳糸镱犰┅磲玟轵ㄦ豉疱ㄦ躅泗轱ì鲥悱豉疱鲥悱豉疱镳糸镱犰矧铛祆屐屙孱舡豉疱┅鲠祯弩怙镬遽镳糸镱犰┅羼飑ㄦ豉疱ㄦ躅泗轱ì鲥悱豉疱鲥悱豉疱鲠祯弩鲥悱豉疱镳糸镱犰┅徜篚徜洹篚狻ㄦ豉疱ㄦ躅泗轱ì鲥悱豉疱屐屙孱舡豉疱屐屙孱舡豉疱鲠祯弩鲥悱豉疱镳糸镱犰┅徜洫徜洫篚猹篚猹箦簟ㄦ豉疱ㄦ躅泗轱ì鲥悱豉疱屐屙孱舡豉疱鲠祯弩鲥悱豉疱镳糸镱犰┅眭溟眭臁溟觥ㄦ豉疱ㄦ躅泗轱ì鲥悱豉疱ㄩㄥф轼铛屐屙孱舡豉疱啜鲠祯弩蝈犰镳糸镱犰啜鲠祯弩屐屙孱舡豉疱镳糸镱犰┅磲珙轸蹁戾铉翳犷珈溟蝈泗轱瞟鏖翳骖鲥悱豉疱屐屙孱舡豉疱ㄤ彐躅弪ī⒁弭躜骝弩弪鲥泗矧鲥ㄣ镥蜚К屐屙孱舡豉疱ㄣ镥蜚К屐屙孱舡豉疱┅ㄤ彐躅躅轸ī⒁弭躜躅轸鲥泗矧轭翳溟蝈泗轱町鲥ㄣ镥蜚К屐屙孱舡豉疱ㄣ镥蜚К屐屙孱舡豉疱┅ㄤ彐躅躅轸ī⒁弭躜躅轸鲥泗矧轭翳溟蝈泗轱町鲥ㄣ镥蜚К屐屙孱舡豉疱ㄣ镥蜚К屐屙孱舡豉疱┅ㄤ彐躅箦簟⒛弩趄蹉糸鲥禊箦翳泔眇镱孱趔镦圉麸帏犷帙喱蝈趱蝾轭圉喈箦翩鲥悱雯鲥悱雯雯ㄤ彐躅磲玟轵磲珙轸蹁溟蝈泗轱瞟⒚蝈狒骝弩鲥泗矧鏖翳翳玳鲥囗徵铋趱溴犷噤轵邈糸镱喈换麸滹骈珲蝈翳轶秕骘轭翦珏鲥泗矧鲥í磲珙轸蹁ㄣ矬溟蝈泗轱瞟í磲珙轸蹁箝溟蝈泗轱瞟┅ㄤ彐躅羼霰霾镳糸镱犰屦箝祜瞟⒁弭躜麒弭桢圉编犷圉侧狎泔眇镱孱赭轶嘟喈涉噱痼殪镱轶玳鲥瞵翳轶轭篝遽汨邈塍翳狒遽汨疳轵镦泔眇镱孱趔狎鏖翳轭噱痼殪镱镦遽汨雉桢虍ㄩ屦箝祜ㄡ钿冀ㄡ怏ō鲥悱霰鲥悱霾┅屦箝祜瞟冀ㄡ怏ō鲥悱霰鲥悱霾┅屦箝祜瞟ㄡ钿鲥悱霰鲥悱霾┅鲥悱霰鲥悱霾┅┅ㄤ彐躅徜霰霾⒘滗圉编犷圉侧泔眇镱孱赭轶瀣蝈趱蝾轭铄鲥泗矧鲥黩狃ǐ鲥悱霰鲥悱霾┅黩狃ǐ鲥悱霰鲥悱霾┅┅ㄤ彐躅徜洫⒘滗帏犷帙麸翳泔眇镱孱趔镦圉喱蝈趱蝾轭铄鲥泗矧鲥黩狃ǐ鲥悱雯┅黩狃ǐ鲥悱雯┅┅ㄤ彐躅徜洹霰霾⒛弩趄蹉糸鲥禊躔溽翦圉编怡徜溟铉圉侧泔眇镱孱赭轶瀣蝈趱蝾轭圉编箦翩鲥悱霰黩狃ǐ鲥悱霰鲥悱霾┅鲥悱霰黩狃ǐ鲥悱霰鲥悱霾┅┅霰ㄤ彐躅徜洫⒛弩趄蹉糸鲥禊躔溽翦圉怡徜溟铉帏犷帙喱蝈趱蝾轭圉喈箦翩鲥悱雯黩狃ǐ鲥悱雯┅鲥悱雯黩狃ǐ鲥悱雯┅雯ㄤ彐躅篚霰霾⒂踱趄徙圉编犷圉侧泔眇镱孱赭轶瀣蝈趱蝾轭铄鲥泗矧鲥黩狃ō鲥悱霰鲥悱霾┅黩狃ō鲥悱霰鲥悱霾┅┅ㄤ彐躅篚猹⒂踱趄徙帏犷帙骝镯翳泔眇镱孱趔镦圉喱蝈趱蝾轭铄鲥泗矧鲥黩狃ō鲥悱雯┅黩狃ō鲥悱雯┅┅ㄤ彐躅篚狻霰霾⒛弩趄蹉糸鲥禊躔溽翦圉编怡篚怍蜥泗轭圉侧泔眇镱孱赭轶瀣蝈趱蝾轭圉编箦翩鲥悱霰黩狃ō鲥悱霰鲥悱霾┅鲥悱霰黩狃ō鲥悱霰鲥悱霾┅┅霰ㄤ彐躅篚猹⒛弩趄蹉糸鲥禊躔溽翦圉怡篚怍蜥泗轭帏犷帙喱蝈趱蝾轭圉喈箦翩鲥悱雯黩狃ō鲥悱雯┅鲥悱雯黩狃ō鲥悱雯┅雯ㄤ彐躅眭筱犰狎⑼蹯糸痨翳泔眇镱孱趔镦圉怡囿汜灬蜞蝈趱蝾轭铄鲥泗矧鲥黩狃í鲥悱雯筱犰狎┅黩狃í鲥悱雯筱犰狎┅┅ㄤ彐躅眭臁筱犰狎⒛弩趄蹉糸鲥禊眭祠轲禊翳泔眇镱孱趔镦圉怡囿汜灬蜞蝈趱蝾轭圉喈箦翩鲥悱雯黩狃í鲥悱雯筱犰狎┅鲥悱雯黩狃í鲥悱雯筱犰狎┅雯ㄤ彐躅溟筱犰狎⒛轹殇翳泔眇镱孱趔镦圉怡囿汜灬蜞蝈趱蝾轭铄鲥泗矧鲥黩狃ǒ鲥悱雯筱犰狎┅黩狃ǒ鲥悱雯筱犰狎┅┅ㄤ彐躅溟觥筱犰狎⒛弩趄蹉糸鲥禊溟鲩溴翳泔眇镱孱趔镦圉怡囿汜灬蜞蝈趱蝾轭圉喈箦翩鲥悱雯黩狃ǒ鲥悱雯筱犰狎┅鲥悱雯黩狃ǒ鲥悱雯筱犰狎┅雯ㄤ彐躅ì磲珙轸蹁戾铉翳雯⒁弭躜翳磲珙轸蹁镦圉喈篑螋ǐ篑踽蝈鲥悱雯篑踽蝈鲥悱雯┅┅ㄤ彐躅ì犷珈溟蝈泗轱瞟雯⒁弭躜翳犷珈镦圉喈ㄡ翎鲥悱雯鲥悱雯┅ㄤ彐轭瀛篦辁戾鲥悱豉疱┅┅ㄤ彐鲥悴镳鲥悴蝈犰ㄤ彐鲥悴镳鲥悴箝铉戾骒镝舂ㄤ彐鲥悴镳鲥悴滹踱戾骒镝舂ㄤ彐鲥悴镳鲥悴骈铛愆换换鱼蜥翥ㄤ邈灬轫镳糸黹箴邋畅筢驽豉暴ㄤ邂蹒暴┅ㄤ邈灬轫镳糸黹箴邋畅筢驽豉癌ㄤ邂蹒癌┅鲥悴榄羼鲥悴姝徜鲥悴姝徜洫鲥悴姝徜洹鲥悴姝徜洫鲥悴姝箦簟鲥悴姝篚猹鲥悴姝徜洹鲥悴姝篚狻鲥悴姝眭臁鲥悴姝溟鲥悴姝眭鲥悴姝鲥悴姝鲥悴鲥悴姝溟觥鲥悴姝躅轸